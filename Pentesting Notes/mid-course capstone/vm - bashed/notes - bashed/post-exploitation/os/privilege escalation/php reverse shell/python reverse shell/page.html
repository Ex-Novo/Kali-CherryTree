<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Python Reverse Shell</title>
</head><body><br/>
We are still the (www-data) user here:<br/>
We can't access the tty (the software part that output commands to the terminal)<br/>
We need to improve our situation with... <b>TTY ESCAPE COMMANDS!!!</b><br/>
<a href="https://netsec.ws/?p=337">https://netsec.ws/?p=337<br/>
</a><img src="1 15.png" /><a href="https://netsec.ws/?p=337"><br/>
</a><a href="https://netsec.ws/?p=337"><br/>
</a><img src="2 3.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\18.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\19.png" /><br/>
<br/>
<br/>
Let's try some methods:<br/>
Python worked!!! (But we changed form <b>/bin/sh</b>&nbsp;to <b>/bin/bash</b>)<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\20.png" /><br/>
<img src="1 16.png" /><br/>
<br/>
Better see what we can do over there.<br/>
The attempt to log as a scriptmanager failed (we are trying a blank password)<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\21.png" /><br/>
<img src="1 17.png" /><br/>
<br/>
<br/>
<br/>
We can try something smarter:<br/>
Execute a command as a <b>scriptmanager</b>&nbsp;like /bin/bash and login as him!!!<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\22.png" /><br/>
<img src="1 18.png" /><br/>
<br/>
<br/>
<br/>
We are logged as <b>scriptmanager</b>&nbsp;now!!<br/>
But we have no sudo access, so no big deal<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\23.png" /><br/>
<img src="1 19.png" /><br/>
<br/>
<br/>
<br/>
If we searc htrough folders, we can see an unusual <b>“script”</b>&nbsp;folder into / folder<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\24.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\25.png" /><br/>
<img src="1 20.png" /><br/>
<br/>
<img src="2 4.png" /><br/>
<br/>
<br/>
<br/>
<br/>
We can see an interesting thing here:<br/>
The <b>“test.txt”</b>&nbsp;file is written at <b>13:33</b>&nbsp;(the date when I went into the folder) and it is <b>root:root</b>&nbsp;<br/>
by the python <b>“test.py”</b>&nbsp;file every minute<br/>
<br/>
Our idea can be: overwrite the python file with a reverse shell!!!<br/>
<a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet<br/>
<img src="1 21.png" /><br/>
<br/>
</a><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\26.png" /><br/>
REMEMBER: SUBSTITUTE <b>“/bin/sh”</b>&nbsp;with <b>"/bin/bash"</b><br/>
&nbsp;CHANGE THE S.CONNECT VALUES <b>WITH YOUR IP ADDRESS</b>&nbsp;AND A <b>NEW PORT</b>&nbsp;(E.G 2345)<br/>
<img src="1 22.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\27.png" /><br/>
<br/>
<br/>
Copy the green part (<b>changed with right values</b>), paste into the test.py file and start a listener<br/>
(To change the test.py file you can use <b>nano</b>&nbsp;if it is available or the <b>SimpleHTTPServer + wget</b>&nbsp;method)<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\28.png" /><br/>
<img src="1 23.png" /><br/>
<br/>
Wait a minute and....<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\29.png" /><br/>
<img src="2 5.png" /><br/>
<br/>
</body></html>