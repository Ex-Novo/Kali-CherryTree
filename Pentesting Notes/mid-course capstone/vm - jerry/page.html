<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>VM - Jerry</title>
</head><body>&nbsp; &nbsp; &nbsp; &nbsp; <b>Walktrough - Jerry</b><br/>
<br/>
<br/>
<b><i>Windows Machine</i></b><br/>
<br/>
First, start a "<b>nmap -T4 -A -p- IPADDRESS"</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\1.png" /><br/>
<img src="1.png" /><br/>
<br/>
The only one port open is 8080: <b>Apache Tomcat/7.0.88</b><br/>
Better see what we can do with this only one port open<br/>
<br/>
<br/>
<b>################################################################</b><br/>
<br/>
<br/>
<b>Web Server</b><br/>
<br/>
<br/>
First step is to check the web server trough a Web Browser:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\2.png" /><br/>
<img src="1 2.png" /><br/>
<br/>
We can log into the “Manager App” to do malicious things:<br/>
Better find some default credentials to try a bruteforce login:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\3.png" /><br/>
<img src="1 3.png" /><br/>
<br/>
<br/>
You can use many tools to try a bruteforce login: here we will use a manual way Burp Suite<br/>
We can ask for the login page of “Manager App” and send a request to Burp Suite Interceptor<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\4.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\5.png" /><br/>
<img src="1 4.png" /><br/>
<br/>
<img src="2.png" /><br/>
<br/>
<br/>
We can send the Intercepted request to the Decoder:<br/>
We see that the response is coded in Base64 (see the == sign at the end)<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\6.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\7.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\8.png" /><br/>
<img src="1 5.png" /><br/>
<br/>
<img src="2 2.png" /><br/>
<br/>
<img src="3.png" /><br/>
<br/>
<br/>
It was coded the <b>USERNAME:PASSWORD</b>&nbsp;format!!!<br/>
Before getting started, set the username:password format for the default credentials.<br/>
We can use a <b>one-liner</b>&nbsp;to convert the list in a Base64 format<br/>
<br/>
Input:<br/>
<img src="1 6.png" /><br/>
<br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\9.png" /><br/>
One-Liner:<br/>
<img src="2 3.png" /><br/>
<br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\10.png" /><br/>
Output:<br/>
<img src="3 2.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\11.png" /><br/>
<br/>
<br/>
Now we can try Intuder Sniper (one payload)<br/>
Add the Base64 parameter to change and go on<br/>
<img src="1 7.png" /><br/>
<br/>
<img src="2 4.png" /><br/>
<br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\12.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\13.png" /><br/>
And DEACTIVEATE URL ENCODE (DOWN BELOW): <br/>
We can't encode this type of chars like ==<br/>
<img src="1 8.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\14.png" /><br/>
<br/>
<br/>
And try now to attack.<br/>
We got a result: <b>tomcat:s3cret</b>&nbsp;default login!<br/>
<img src="1 9.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\15.png" /><br/>
<br/>
<br/>
Now we can login manually and see what happen.<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\16.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\17.png" /><br/>
<img src="1 10.png" /><br/>
<img src="2 5.png" /><br/>
<br/>
<br/>
Down below, we can upload a WAR file:<br/>
<b>we can create a malicious WAR file with a reverse shell!!</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\18.png" /><br/>
<img src="1 11.png" /><br/>
<br/>
<br/>
We can use MSFVenom to create the WAR payload with reverse shell:<br/>
<a href="https://netsec.ws/?p=331">https://netsec.ws/?p=331</a><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\19.png" /><br/>
<img src="1 12.png" /><br/>
<br/>
<br/>
We can generate the payload and use Metasploit to listen:<br/>
This time we can use the manual method to learn more how to do that without Metasploit<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\20.png" /><br/>
<img src="1 13.png" /><br/>
<br/>
<br/>
Set up the netcat listener:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\21.png" /><br/>
<img src="2 6.png" /><br/>
<br/>
<br/>
<br/>
And load the WAR file.<br/>
We will se the file loaded with the other one<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\22.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\23.png" /><br/>
<img src="1 14.png" /><br/>
<br/>
<img src="2 7.png" /><br/>
<br/>
<br/>
<br/>
Now, load the page and see the netcat listener:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\24.png" /><br/>
<img src="1 15.png" /><br/>
<br/>
</body></html>