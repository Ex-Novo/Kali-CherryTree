<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Testing for Broken Authentication</title>
</head><body><b><u><div style="text-align: center"><span style="font-size: 20pt">Testing for Broken Authentication</span></div></u></b><br/>
<br/>
<br/>
<span style="font-size: 15pt">To test the authentication, we need to log out and go back to the login page.<br/>
<br/>
Some web apps, when you try to login,<br/>
will tell you if ONLY the email or the password is wrong, implicity telling<br/>
that the other parameter is ok!!!<br/>
<br/>
We can try something:<br/>
In this case, the error message doesn't tell us what is wrong<br/>
<img src="1.png" /><br/>
<br/>
<br/>
<br/>
We can try for "Forgot your password":<br/>
If we insert some bad email, we can not use the <b>"Secret Question"</b>&nbsp;form:<br/>
</span><img src="1 2.png" /><br/>
<br/>
<br/>
<span style="font-size: 15pt">But, if we insert an existing email (the admin one, obtained by looking into the profile from SQL Injection)<br/>
tell us that we can write into the field, in brief: that the email exist!!<br/>
</span><img src="3.png" /><br/>
<br/>
<br/>
<br/>
<span style="font-size: 15pt">Other things we can check is Account Fixation:<br/>
We can create an account real quick<br/>
</span><img src="1 3.png" /><span style="font-size: 15pt"><br/>
</span><span style="font-size: 15pt"><br/>
</span><br/>
<span style="font-size: 15pt">Now, before login, we can try to get a request of the home page:<br/>
that is to check our SessionID if it changes or rotate when we login or logout<br/>
<br/>
Intercept the request of the login page and send to the <b>Repeater</b>,<br/>
<img src="1 4.png" /><br/>
<br/>
<br/>
Now, turn off the interceptor in Burp Suite, log in, turn on and intercept the new request:<br/>
<img src="3 2.png" width="950" height="334" /><br/>
</span></body></html>