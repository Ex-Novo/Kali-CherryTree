<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>VM - Netmon</title>
</head><body>&nbsp; &nbsp; &nbsp; &nbsp; <b>Walktrough - Netmon</b><br/>
<br/>
<br/>
<b><i>Windows Machine</i></b><br/>
<br/>
First, start a "<b>nmap -T4 -A -p- IPADDRESS"</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\1.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\2.png" /><br/>
<img src="1.png" /><br/>
<br/>
<img src="2.png" /><br/>
<br/>
<br/>
<br/>
We have a lot over here:<br/>
FTP server on port 21,<br/>
web server on port 80 (Indy),<br/>
SMB on port 139/445,<br/>
Microsoft HTTPAPI on port 5985/47001<br/>
and a lot of RCP calls<br/>
<br/>
<br/>
<b>################################################################</b><br/>
<br/>
<br/>
<b>Web Server</b><br/>
<br/>
<br/>
We can use FTP to put a malicious file and get executed with a Web Server Request.<br/>
We can see in the nmap scan that there is <b>“inetpub”</b>&nbsp;folder: it is an IIS Web Folder<br/>
<br/>
<br/>
First of all, check the webpage:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\3.png" /><br/>
<img src="1 2.png" /><br/>
<br/>
<br/>
<br/>
Version <b>18.1.37 of PRTG Network Manager</b><br/>
Everytime we see a default login page, we can search for default credentials:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\4.png" /><br/>
<img src="1 3.png" /><br/>
<br/>
<br/>
<br/>
Default credentials didn't work.<br/>
We can search more on <b>searchsploit</b>:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\5.png" /><br/>
<img src="1 4.png" /><br/>
<br/>
<br/>
We can search for where the data are stored:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\6.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\7.png" /><br/>
<img src="1 5.png" /><br/>
<br/>
<img src="2 2.png" /><br/>
<br/>
<br/>
<br/>
Using the FTP Server, we found the <b>Paessler</b>&nbsp;folder in: %ALLUSERSPROFILE%\Application data\Paessler\PRTG Network Monitor\V7<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\8.png" /><br/>
<img src="1 6.png" /><br/>
<br/>
<br/>
<br/>
<br/>
We can see some interesting files over there: the <b>.old</b>&nbsp;and the <b>.bak (backups)</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\9.png" /><br/>
<img src="1 7.png" /><br/>
<br/>
<br/>
<br/>
Searching trough the files, we can see in the old.bak file:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\10.png" /><br/>
<img src="1 8.png" /><br/>
<br/>
<br/>
<br/>
If we try to login with this credentials, we fail.<br/>
The password is: <b>PrTg@dmin2018</b><br/>
We can try with <b>PrTg@dmin2019</b>&nbsp;, <b>PrTg@dmin2020 etc.</b><br/>
The <b>PrTg@dmin2019</b>&nbsp;work!<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\11.png" /><br/>
<img src="1 9.png" /><br/>
<br/>
<br/>
<br/>
The exploit to work needs a cookie (you can obtain it with Burp Suite) from the authenticated login<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\12.png" /><br/>
<img src="1 10.png" /><br/>
<br/>
<br/>
<br/>
We will use the .sh script for RME (seen in searchsploit)<br/>
<img src="1 11.png" /><br/>
<img src="2 3.png" /><br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\13.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\14.png" /><br/>
<br/>
<br/>
We can use other tools like <b>Impacket</b>&nbsp;and you can run like:<br/>
<b>psexec.py, smbexec.py, wmiexec.py etc.</b><br/>
(Are less likely to be stopped from antiviruses)<br/>
... or just use another way to log in<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\15.png" /><br/>
<img src="1 12.png" /><br/>
<br/>
<img src="2 4.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\16.png" /><br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\17.png" /></body></html>