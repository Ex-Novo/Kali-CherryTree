<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>VM - Grandpa</title>
</head><body>&nbsp; &nbsp; &nbsp; &nbsp; <b>Walktrough - Granpa</b><br/>
<br/>
<br/>
<b><i>Windows Machine</i></b><br/>
<br/>
First, start a "<b>nmap -T4 -A -p- IPADDRESS"</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\1.png" /><br/>
<img src="1.png" /><br/>
<br/>
<br/>
<br/>
We have a <b>port 80 open with Microsoft IIS httpd 6.0</b>&nbsp;and a <b>probably Windows machine</b><br/>
<br/>
<br/>
<b>################################################################</b><br/>
<br/>
<br/>
<b>Web Server</b><br/>
<br/>
<br/>
The <b>PUT</b>&nbsp;Method allow us to put some file in there,<br/>
The TRACE Method allow us to do <b>Cross Site Tracing</b>:<br/>
it happens when you have a <b>Cross Site Scripting Vulnerability</b>&nbsp;and the possibility to run TRACE<br/>
<br/>
<br/>
Let's first take a look at the homepage:<br/>
<img src="1 2.png" /><br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\2.png" /><br/>
<br/>
<br/>
It is an old page of under construction.<br/>
Better search for some exploits online:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\3.png" /><br/>
<img src="1 3.png" /><br/>
<br/>
<img src="2.png" /><br/>
<br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\4.png" /><br/>
<br/>
<br/>
We can use Metasploit to use the ruby module:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\5.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\6.png" /><br/>
<img src="1 4.png" /><br/>
<br/>
<img src="2 2.png" /><br/>
<br/>
<br/>
<br/>
What a luck, we can use the PROPFIND Method!!<br/>
Run the exploit: may can take some times, so try more times<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\7.png" /><br/>
<img src="1 5.png" /><br/>
<br/>
<br/>
<br/>
Strangely, getuid failed, so better look at more users/processes running on the machine:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\8.png" /><br/>
<img src="1 6.png" /><br/>
<br/>
<br/>
<br/>
There are 2 logged on users, use <b>“ps”</b>&nbsp;to show the processes.<br/>
We can use <b>“migrate”</b>&nbsp;command to change process and try to be another user:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\9.png" /><br/>
<img src="1 7.png" /><br/>
<br/>
<br/>
<br/>
We can use the <b>SUGGESTOR</b>&nbsp;to get more modules for <b>Post-Exploitation</b><br/>
(Or other script and manual ways to get more Post-Exploitation values)<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\10.png" /><br/>
<img src="1 8.png" /><br/>
<br/>
<br/>
<br/>
So, try the Post-Exploit (if one doesn't work, try more times or another one)<br/>
We can try <b>kitrap0d</b>:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmph3wu0o\11.png" />&nbsp;<img src="1 9.png" /><br/>
</body></html>